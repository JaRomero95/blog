<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Avoid Vue.set - Reactivity and immutability" /><meta name="author" content="Juan Antonio Romero Molero" /><meta property="og:locale" content="en" /><meta name="description" content="Learn about the alternatives to Vue.set and why you should choose them" /><meta property="og:description" content="Learn about the alternatives to Vue.set and why you should choose them" /><link rel="canonical" href="https://www.jaromero.es/posts/avoid-vue-set/" /><meta property="og:url" content="https://www.jaromero.es/posts/avoid-vue-set/" /><meta property="og:site_name" content="J. A. Romero" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-16T18:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Avoid Vue.set - Reactivity and immutability" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Juan Antonio Romero Molero"},"datePublished":"2020-01-16T18:00:00+01:00","description":"Learn about the alternatives to Vue.set and why you should choose them","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jaromero.es/posts/avoid-vue-set/"},"url":"https://www.jaromero.es/posts/avoid-vue-set/","@type":"BlogPosting","headline":"Avoid Vue.set - Reactivity and immutability","dateModified":"2021-11-06T16:27:20+01:00","@context":"https://schema.org"}</script><title>Avoid Vue.set - Reactivity and immutability | J. A. Romero</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="J. A. Romero"><meta name="application-name" content="J. A. Romero"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div class="site-title mt-3"> <a href="/">J. A. Romero</a></div><div class="site-subtitle font-italic">The code speak only of what it knows</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href=" javascript:location.href = 'mailto:' + ['romero.r4l','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Avoid Vue.set - Reactivity and immutability</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Avoid Vue.set - Reactivity and immutability</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Juan Antonio Romero Molero </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jan 16, 2020, 6:00 PM +0100" >Jan 16, 2020<i class="unloaded">2020-01-16T18:00:00+01:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 6, 2021, 4:27 PM +0100" >Nov 6<i class="unloaded">2021-11-06T16:27:20+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1281 words">7 min read</span></div></div><div class="post-content"><h2 id="introduction">Introduction</h2><p>Vue uses reactivity to listen for changes in component data and update the view if necessary after a change.</p><p>To achieve this, Vue adds getters and setters that wrap each property that we define. When we modify a value, we are calling the setter method that was created earlier. Through this setter, Vue can notice the change.</p><p>However, there are some situations where we find that our component does not update after a value changes.</p><h2 id="reactivity-problems">Reactivity problems</h2><p>Let’s look at the following component:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">post</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">title</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The Last Wish</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">}),</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">toggleFav</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span> <span class="o">=</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>And its template:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;h1&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">v-if=</span><span class="s">"post.fav"</span><span class="nt">&gt;</span>♥<span class="nt">&lt;/span&gt;</span>
    Hello!
  <span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;button</span> <span class="err">@</span><span class="na">click=</span><span class="s">"toggleFav"</span><span class="nt">&gt;</span>Fav<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></table></code></div></div><p>If we run this example and try to use the button, we’ll see that the page does not change. However, if we debug the component with the browser development tools, we’ll see that the <code class="language-plaintext highlighter-rouge">fav</code> value changes even if the view does not reflect it.</p><p>We commented before that Vue adds getters and setters to the properties we defined in our component. The <code class="language-plaintext highlighter-rouge">fav</code> field, as we didn’t declare it within the <em>post</em> model in the data of our component and we add it later, it has not been initialized correctly so it does not have these methods and Vue does not detect any change when we modify it.</p><p>Fixing this problem would be as easy as setting an initial value for the <code class="language-plaintext highlighter-rouge">fav</code> field:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">// ...</span>
<span class="nx">data</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">post</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">title</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The Last Wish</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">fav</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// ...</span>
</pre></table></code></div></div><p>There are some situations where Vue cannot detect changes:</p><ul><li>New properties added to an existing object<li>Properties removed from an object<li>Set an element to a specific position in an array<li>Changes in the length of an array</ul><blockquote><p>To avoid problems with common situations such as mutations in arrays, Vue transparently overwrites some of its methods, since otherwise, it would not be able to detect the mutations made when we invoke them. The methods Vue modify so that you can use them without worrying about reactivity are: <code class="language-plaintext highlighter-rouge">push</code>, <code class="language-plaintext highlighter-rouge">pop</code>, <code class="language-plaintext highlighter-rouge">shift</code>, <code class="language-plaintext highlighter-rouge">unshift</code>, <code class="language-plaintext highlighter-rouge">splice</code>, <code class="language-plaintext highlighter-rouge">sort</code> and <code class="language-plaintext highlighter-rouge">reverse</code>. But I recommend you don’t use them too, for the same reasons I explained in this article.</p></blockquote><h2 id="vueset">Vue.set</h2><p>Probably you already knew about reactivity in Vue and these specific cases, but I wanted to reintroduce them to talk about one of the proposed solutions for this problem, which is the <code class="language-plaintext highlighter-rouge">set</code> method of Vue.</p><p>Here are some examples:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// Vue.set(object, propertyName, value)</span>

<span class="nx">Vue</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">,</span> <span class="dl">'</span><span class="s1">fav</span><span class="dl">'</span><span class="p">,</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">);</span>

<span class="k">this</span><span class="p">.</span><span class="nx">$set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">,</span> <span class="dl">'</span><span class="s1">fav</span><span class="dl">'</span><span class="p">,</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">);</span>

<span class="k">this</span><span class="p">.</span><span class="nx">$set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">post</span><span class="p">);</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Vue.set</code> simply ensures that the new value is set as a reactive property, solving the problem of not having declared it initially.</p><p>Is a quick and easy solution, but in my opinion, we should avoid this method.</p><h2 id="why-avoid-vueset">Why avoid Vue.set</h2><p>Reactivity problems in Vue usually stem from a poorly designed component and come to light when we try to mutate an object. Using a brute force method like this prevents us from doing the right thing: refactoring.</p><p>Our components should be as small as possible, because the easier it is to extract the component code to another place, the easier it will be to add or modify functions. Otherwise, this method couples the code to the Vue API, forcing us to change the code before we can move to a non-component file.</p><p>Finally, avoiding using this method forces us to know more about immutability and its benefits in JavaScript, knowledge that will help us write pure and reusable functions and avoid having to face a tough debugging process due to unexpected mutations.</p><h2 id="vueset-alternatives">Vue.set alternatives</h2><p>If we are faced with one of the cases listed above, in which Vue cannot detect changes in our components, we have different options depending on the situation.</p><h3 id="new-properties-added-to-an-existing-object">New properties added to an existing object</h3><p>In this case, we’ll choose to create a new object containing all previous properties plus the one we are adding. Then we can change the reference to our new object. Vue will easily detect the change and update the view based on the new value.</p><p>For this, we have two options. First, using <code class="language-plaintext highlighter-rouge">Object.assign</code>:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">toggleFav</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">,</span> <span class="p">{</span><span class="na">fav</span><span class="p">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">});</span>
<span class="p">}</span>
</pre></table></code></div></div><p>And second, the one I prefer, using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax">spread syntax</a>:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">toggleFav</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">,</span> <span class="na">fav</span><span class="p">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">};</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="properties-removed-from-an-object">Properties removed from an object</h3><p>If what you want is not to add, but remove a property of an object, we can also do it without mutating it. We have several options, one of these will be to clone the object, delete the property and, as in the previous example, replace the object.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nx">deleteFavProperty</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">post</span> <span class="o">=</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">};</span>
  <span class="k">delete</span> <span class="nx">post</span><span class="p">.</span><span class="nx">fav</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="nx">post</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p>Be careful with objects that contain another object in some of their properties, because if you clone them in this way, child objects won’t be cloned and you could unintentionally mutate them. Use another method of cloning or avoid working with complex objects if you can.</p></blockquote><p>We have another alternative. Here we can make use of <a href="https://github.com/tc39/proposal-object-rest-spread">rest/spread</a>, which again is the one I prefer.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nx">deleteFavProperty</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span><span class="nx">fav</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="nx">rest</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="set-an-element-to-a-specific-position-in-an-array">Set an element to a specific position in an array</h3><p>If we try to do the following:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">replacePost</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">newPost</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newPost</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We’ll see that Vue does not detect it either. The simplest option to avoid using <code class="language-plaintext highlighter-rouge">Vue.set</code> would be the <code class="language-plaintext highlighter-rouge">Array.splice</code>. Let’s see how it looks:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">replacePost</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">newPost</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">newPost</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>But yes, this <strong>method mutates the array</strong>. We mentioned earlier that Vue replaces some <code class="language-plaintext highlighter-rouge">Array</code> methods to be able to detect changes, and this is one of them.</p><p>However, we prefer to avoid mutations because some higher or lower components in our composition could be using this data. So we can apply one of the following options:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nx">replacePost</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">newPost</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// A</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">post</span><span class="p">,</span> <span class="nx">postIndex</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">postIndex</span> <span class="o">===</span> <span class="nx">index</span> <span class="p">?</span> <span class="nx">newPost</span> <span class="p">:</span> <span class="nx">post</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="c1">// B</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">([],</span> <span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">,</span> <span class="p">{[</span><span class="nx">index</span><span class="p">]:</span> <span class="nx">newPost</span><span class="p">});</span>

  <span class="c1">// C</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">index</span><span class="p">),</span>
    <span class="nx">newPost</span><span class="p">,</span>
    <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="changes-in-the-length-of-an-array">Changes in the length of an array</h3><p>Finally, we have the least common case, the modification of the length of an array:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">incrementPostsLength</span><span class="p">(</span><span class="nx">numberOfEmptySpaces</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">.</span><span class="nx">length</span> <span class="o">+=</span> <span class="nx">numberOfEmptySpaces</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we test this case, we’ll see that Vue does not detect it. There are a few options to do this. One of them will be to create a new array with the number of elements that we want to add and concatenate it at the end of the original, giving rise to a new one:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nx">incrementPostsLength</span><span class="p">(</span><span class="nx">numberOfEmptySpaces</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">emptySpaces</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">numberOfEmptySpaces</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">,</span> <span class="p">...</span><span class="nx">emptySpaces</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="conclusion">Conclusion</h2><p>I prefer to take advantage of the options the language offers than use the Vue API or any other third-party code when it’s not really necessary, avoiding adding dependencies to my code.</p><p>Don’t get me wrong, third party libraries are useful, but we don’t have to abuse them. <a href="https://you-dont-need.github.io/You-Dont-Need-Lodash-Underscore/#/">The abuse of “lodash” is a clear example of this</a>.</p><p>If you choose these options, your code will be more portable and you’ll learn how to take advantage of immutability, a knowledge that you can apply in your next JavaScript development, whatever framework you use.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/frontend/'>Frontend</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/vue/" class="post-tag no-text-decoration" >vue</a> <a href="/tags/immutability/" class="post-tag no-text-decoration" >immutability</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Avoid Vue.set - Reactivity and immutability - J. A. Romero&url=https://www.jaromero.es/posts/avoid-vue-set/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Avoid Vue.set - Reactivity and immutability - J. A. Romero&u=https://www.jaromero.es/posts/avoid-vue-set/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Avoid Vue.set - Reactivity and immutability - J. A. Romero&url=https://www.jaromero.es/posts/avoid-vue-set/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.jaromero.es/posts/avoid-vue-set/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jekyll/">Jekyll, a tool for creating blogs focused on developers</a><li><a href="/posts/ruby-tap-method/">The tap method in Ruby</a><li><a href="/posts/avoid-vue-set/">Avoid Vue.set - Reactivity and immutability</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/clean-code/">clean code</a> <a class="post-tag" href="/tags/immutability/">immutability</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/ruby/">ruby</a> <a class="post-tag" href="/tags/vue/">vue</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ruby-tap-method/"><div class="card-body"> <span class="timeago small" >Sep 10, 2019<i class="unloaded">2019-09-10T19:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The tap method in Ruby</h3><div class="text-muted small"><p> Introduction Ruby’s tap method is as simple as it is effective, although not many use it. This method belongs to the Object class and basically what it does when we invoke it on an instance is se...</p></div></div></a></div><div class="card"> <a href="/posts/jekyll/"><div class="card-body"> <span class="timeago small" >Aug 24, 2019<i class="unloaded">2019-08-24T19:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Jekyll, a tool for creating blogs focused on developers</h3><div class="text-muted small"><p> Introduction If you are a developer and you would like to have your blog, with Jekyll you can create it quickly and maintain full control to customize it. Jekyll allows us to write our posts usin...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ruby-tap-method/" class="btn btn-outline-primary" prompt="Older"><p>The tap method in Ruby</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="">Juan Antonio Romero Molero</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/clean-code/">clean code</a> <a class="post-tag" href="/tags/immutability/">immutability</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/ruby/">ruby</a> <a class="post-tag" href="/tags/vue/">vue</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-85242334-2"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-85242334-2'); }); </script>
